<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR POC</title>
</head>

<body>
  <h1>AR POC</h1>
  <a id="arLink" href="#">Abrir AR</a>

  <script>
    function getDevice() {
      if (/Android/i.test(navigator.userAgent)) {
        return "android";
      }

      if (/iPhone/i.test(navigator.userAgent)) {
        return "iphone";
      }

      return "fallback";
    }

    function buildSceneViewerUrl() {
      var androidFile = `https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/GlamVelvetSofa/glTF/GlamVelvetSofa.gltf`;
      var package = `com.google.android.googlequicksearchbox`;
      var scheme = `https`;
      var action = `android.intent.action.VIEW`;
      var fallBackUrl = `wrong.html`;
      var sceneViewer = `intent://arvr.google.com/scene-viewer/1.0`;

      return `${sceneViewer}?file=${androidFile}#Intent;scheme=${scheme};action=${action};package=${package};S.browser_fallback_url=${fallBackUrl};end;`;
    }


    const devices = {
      iphone: { url: "iphone.usdz", text: "iPhone" },
      android: { url: buildSceneViewerUrl(), text: "Android" },
      fallback: { url: "index.html", text: "Something went wrong (not Android or iPhone)" },
    }


    function updateARLink() {
      var arLink = document.getElementById("arLink");
      var device = getDevice();

      arLink.href = devices[device].url;
      arLink.textContent = `Open AR on ${devices[device].text}`;
    }

    window.onload = updateARLink;
  </script>

</body>

</html>